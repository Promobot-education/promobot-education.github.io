# Руководство пользователя RR Studio

**RR Studio** - десктопное приложение предназначенное для управления Promobot Rooky и Promobot Robox с помощью
алгоритмов Blockly.

## Главное меню (стартовый экран)

Главное меню позволяет выбрать платформу для работы: Rooky или Robox, сменить язык приложения. Также в левом нижнем
находится версия приложения.

![](/RRStudio/user_guide/0.png)

## Rooky

Рабочая зона Rooky представляет собой:

* сверху - функциональная зона с кнопками "Открыть проект", "Сохранить проект", "Сменить устройство", "Отменить
  действие(Blockly)", "Повторить действие(Blockly)", "Очистить рабочую зону Blockly", "Подключить устройство"
* слева - рабочую зону Blockly
* справа - сцену с 3D визуализацией Rooky, таблицу с текущими углами суставов.

![](/RRStudio/user_guide/1.png)

### Подключить устройство

RR Studio подключается к Rosbridge по веб-сокету. Для этого вам нужно ввести ip-адрес [сервера](/RRStudio#rosserver).  
_Опционально можно уточнить порт, если он не соответствует 9090_

![](/RRStudio/user_guide/connection.png) ![](/RRStudio/user_guide/connection2.png)

При успешном подключении появится сообщение "Устройство подключено"

![](/RRStudio/user_guide/connection_success.png)

В случае ошибки появится сообщение "Ошибка подключения. Устройство недоступно".  
_Известные причины ошибки подключения и способы исправления читайте в [FAQ](#rrsfaq)._

![](/RRStudio/user_guide/connection_failure.png)

### Функциональная зона

![](/RRStudio/user_guide/buttons.png)

1. **"Открыть проект"** открывает сохраненный на компьютере проект Blockly в формате **.xml**  
   Нельзя открыть файлы другого расширения или проекты, предназначенные для другой платформы.
2. **"Сохранить проект"** сохраняет проект с рабочей зоны Blockly в память компьютера в формате **.xml**
3. **"Сменить устройство"** выходит из текущей рабочей зоны в главное меню.
4. **"Отменить"** отменяет предыдущую команду.
5. **"Повторить"** повторяет предыдущую команду.
6. **"Очистить рабочую зону Blockly"** перемещает все блоки в корзину.

![](/RRStudio/user_guide/button_disabled.png)  
Кнопка заблокирована

![](/RRStudio/user_guide/button_play.png)  
Кнопка старта скрипта

![](/RRStudio/user_guide/button_pause.png)  
Кнопка паузы скрипта (активна)

![](/RRStudio/user_guide/button_stop.png)  
Кнопка остановки скрипта

### Рабочая зона Blockly

![](/RRStudio/user_guide/blockly_rooky.png)  
Blockly - сторонняя технология. Для обучения пользованию воспользуйтесь
готовыми [туториалами](http://blockly.ru/manual/beginning.html)

### Блоки Rooky

![](/RRStudio/user_guide/blocks_rooky.png)

#### Движение суставов

![](/RRStudio/user_guide/blocks_move_joints.png)  
Блок управления движением руки.

**Время движения** (секунды): число > 0. Рука будет стараться достигнуть точки за это время, и рассчитает скорость
движения исходя из времени и расстояния, но скорость не будет быстрее максимально допустимой.  
Блок может содержать несколько суставов, в данном случае движение этих суставов будет происходить **параллельно**.

| Название сустава | Номер | Диапазон движения |  
| --- | --- |:---:|  
| Повернуть плечевой сустав | 1 | -25..134 |  
| Двигать плечевой сустав | 2 | -0..83 |  
| Повернуть плечо | 3 | -89..83 |  
| Двигать локтевой сустав | 4 | 0..80 |  
| Повернуть локтевой сустав | 5 | -85..85 |  
| Двигать запястье | 6 | -20..31 |  
| Сжать/разжать пальцы | 7 | 0..74 |

#### Положение сервопривода

![](/RRStudio/user_guide/blocks_get_angle.png)

Возвращает число - значение текущего угла выбранного сустава.

#### Все суставы в ноль

![](/RRStudio/user_guide/blocks_reset.png)

Уводит руку в нулевое положение: задает всем суставам угол 0.

#### Откалибровать

![](/RRStudio/user_guide/blocks_calibrate.png)

Запускает калибровку руки.

#### Показание датчика касания / есть касание

![](/RRStudio/user_guide/blocks_touched.png)

"Есть касание" возвращает `true`, если считается, что касание происходит, `false`, если касания нет.  
"Показание датчика касания" возвращает число - показания емкостного датчика касания.

#### Установить порог реакции датчика касания

![](/RRStudio/user_guide/blocks_threshold.png)

Настроить чувствительность блока "есть касание"

### Сцена с 3D моделью руки

![](/RRStudio/user_guide/3drooky.png)

Отображает виртуальное положение руки.  
Вращать камеру вокруг руки можно с помощью нажатие левой кнопки мыши и движение мыши.  
Изменять масштаб возможно с помощью колесика мыши.

### Ручное управление

Ручной режим позволяет двигать рукой, не создавая алгоритмов.

![](/RRStudio/user_guide/config_rooky.png)

"**Сбросить всё**" - эквивалент блоку "**Все суставы в ноль**".  
"**Калибровать**" - эквивалент блоку "**Откалибровать**".  
С помощью ползунков и полей ввода можно подвинуть сустав на выбранный угол, либо задать порог датчика касания.  
_Будьте особенно внимательны, в ручном режиме рука не расслабляется от бездействия. Оставление руки может привести к
перегреву и поломке._

## Robox

Рабочая зона Robox представляет собой:

* сверху - функциональная зона с кнопками "Открыть проект", "Сохранить проект", "Сменить устройство", "Отменить
  действие(Blockly)", "Повторить действие(Blockly)", "Очистить рабочую зону Blockly", "Подключить устройство"
* слева - рабочую зону Blockly
* справа - графики, отображающие информацию с Robox: расстояние, угол, угловая скорость, радар.

![](/RRStudio/user_guide/2.png)

### Подключить устройство

RR Studio подключается к Robox с помощью usb-соединения. Для этого подключите Robox к usb-порту компьютера и выберите
нужное устройство в выпадающем списке.

![](/RRStudio/user_guide/connection_usb.png)

_Известные причины ошибки подключения и способы исправления читайте в [FAQ](#rrsfaq)._

### Рабочая зона Robox

![](/RRStudio/user_guide/blockly_robox.png)

Blockly - сторонняя технология. Для обучения пользованию воспользуйтесь
готовыми [туториалами](http://blockly.ru/manual/beginning.html)

### Блоки Robox

**Важно понимать**, что блоки предназначены для записи значений в регистры Robox. Абсолютно нормально поведение, когда
сервопривод продолжает работать после закрытия RR Studio. Поэтому не забывайте отключать Robox после работы.

#### Включить/выключить питание сервопривода

![](/RRStudio/user_guide/blocks_torque.png)

Включает или отключает питание на сервоприводе. Без включенного питания сервопривод продолжить принимать команды,
позволит переписывать регистры, но двигаться не будет.

#### Установить цель сервопривода

![](/RRStudio/user_guide/blocks_point.png)

Принимает целое число. Задает целевое значение сервопривода (угол, скорость или ШИМ). В зависимости от режима работы.

##### Угол

Принимает целое число от -32768 до +32767.  
Устанавливает целевой угол в диапазоне от -720° до 720°.

##### Угловая скорость

Принимает целое число от -24 до 24.  
Задает угловую скорость вращения сервопривода в оборотах в минуту.

##### ШИМ

Принимает число от 0 до 1000.  
Задает напряжение серводвигателя в процентах. Установленное в блоке значение приводится к процентам с помощью умножения
на 0.1

#### Установить режим

![](/RRStudio/user_guide/blocks_mode.png)

Задает режим работы сервопривода

#### Ограничить скорость вращения сервоприводах

![](/RRStudio/user_guide/blocks_limit.png)

Ограничивает скорость вращения в режиме работы по углу.

#### Установить настройки ПИД-регулятора

![](/RRStudio/user_guide/blocks_PID.png)

Задает настройки ПИД-регулятора, принимает числа от 0 до 50

#### Сканировать

![](/RRStudio/user_guide/blocks_scan.png)

Возвращает массив из двух чисел, где первое - показание ИК датчика в см, второе - показание УЗ датчика в см.  
Если показаний нет, вместо числа возвращается null.

#### Очистить радар

![](/RRStudio/user_guide/blocks_clean_radar.png)

Очищает поле радара от меток.

#### Повернуть сервопривод

![](/RRStudio/user_guide/blocks_move_servo.png)

Синтаксический сахар для блоков "Установить режим работы(угол)" + "Установить цель"

#### Установить скорость вращения

![](/RRStudio/user_guide/blocks_set_speed.png)

Синтаксический сахар для блоков "Установить режим работы(угловая скорость)" + "Установить цель"

#### Установить скважность ШИМ

![](/RRStudio/user_guide/blocks_set_pwm.png)

Синтаксический сахар для блоков "Установить режим работы(ШИМ)" + "Установить цель"

### Ручное управление

![](/RRStudio/user_guide/config_robox.png)

"**Сбросить всё**" - сбрасывает сервопривод к заводским настройкам. С помощью ползунков и полей ввода можно задать цель
сервоприводу, не создавая алгоритмов.

# <a name="rrsfaq"></a>FAQ

## Rooky

### Не подключается

![](/RRStudio/user_guide/faq_rooky_connection.png)

### Rooky не двигается

![](/RRStudio/user_guide/faq_rooky_not_move.png)

## Robox

### Не подключается

<a href="/RRStudio/user_guide/faq_robox_connection.jpg"><img src="/RRStudio/user_guide/faq_robox_connection.jpg" height=""></a>


